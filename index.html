<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Speaking Partner</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- SCREEN 1: Level & Voice Select -->
  <div id="setupScreen" class="screen active">
    <div class="setup-wrap">
      <div class="app-logo">ğŸ—£ï¸</div>
      <h1 class="app-title">Speaking Partner</h1>
      <p class="app-sub">AI-powered English coach</p>

      <div class="section-title">AI Voice</div>
      <div class="gender-row">
        <div class="gender-btn male" onclick="selectGender('male')">
          <span class="g-icon">ğŸ‘¨</span>
          <span class="g-label">Male</span>
        </div>
        <div class="gender-btn female" onclick="selectGender('female')">
          <span class="g-icon">ğŸ‘©</span>
          <span class="g-label">Female</span>
        </div>
      </div>

      <div class="section-title">Your Level</div>
      <div class="level-list">
        <div class="level-item" onclick="selectLevel('beginner')">
          <div class="level-left">
            <span class="level-emoji">ğŸŒ±</span>
            <div>
              <div class="level-name beginner-c">Beginner</div>
              <div class="level-sub">A1 â€” A2 Â· Simple topics</div>
            </div>
          </div>
          <span class="level-arrow">â€º</span>
        </div>
        <div class="level-item" onclick="selectLevel('intermediate')">
          <div class="level-left">
            <span class="level-emoji">ğŸš€</span>
            <div>
              <div class="level-name intermediate-c">Intermediate</div>
              <div class="level-sub">B1 â€” B2 Â· Everyday topics</div>
            </div>
          </div>
          <span class="level-arrow">â€º</span>
        </div>
        <div class="level-item" onclick="selectLevel('advanced')">
          <div class="level-left">
            <span class="level-emoji">ğŸ¯</span>
            <div>
              <div class="level-name advanced-c">Advanced</div>
              <div class="level-sub">C1 â€” C2 Â· Complex debates</div>
            </div>
          </div>
          <span class="level-arrow">â€º</span>
        </div>
      </div>
    </div>
  </div>

  <!-- SCREEN 2: Live Call -->
  <div id="callScreen" class="screen">
    <div class="call-wrap">

      <!-- Top bar -->
      <div class="call-topbar">
        <div class="call-duration" id="callDuration">0:00</div>
        <div class="call-label">English Practice</div>
        <div class="call-level-tag" id="callLevelTag">â€”</div>
      </div>

      <!-- AI Avatar area -->
      <div class="avatar-area">
        <div class="avatar-rings" id="avatarRings">
          <div class="ring ring1"></div>
          <div class="ring ring2"></div>
          <div class="ring ring3"></div>
          <div class="avatar-circle" id="avatarCircle">
            <span id="avatarEmoji">ğŸ¤–</span>
          </div>
        </div>
        <div class="ai-name">AI Partner</div>
        <div class="ai-status" id="aiStatus">Listening...</div>
      </div>

      <!-- Stats row -->
      <div class="stats-row">
        <div class="stat-box">
          <div class="stat-num" id="statExchanges">0</div>
          <div class="stat-lbl">Exchanges</div>
        </div>
        <div class="stat-box">
          <div class="stat-num" id="statWords">0</div>
          <div class="stat-lbl">Words</div>
        </div>
        <div class="stat-box">
          <div class="stat-num" id="statScore">â€”</div>
          <div class="stat-lbl">Score</div>
        </div>
      </div>

      <!-- Last message -->
      <div class="last-msg-box" id="lastMsgBox">
        <div class="last-msg" id="lastMsg">Waiting for AI...</div>
      </div>

      <!-- Feedback box -->
      <div class="feedback-box" id="feedbackBox" style="display:none">
        <div class="feedback-text" id="feedbackText"></div>
      </div>

      <!-- Controls -->
      <div class="call-controls">
        <button class="ctrl-btn end-btn" onclick="endSession()">
          <span>ğŸ“µ</span>
          <span class="ctrl-lbl">End</span>
        </button>

        <div class="mic-wrap" id="micWrap">
          <div class="mic-pulse" id="micPulse"></div>
          <button class="mic-btn" id="btnMic" onclick="toggleRecording()">ğŸ¤</button>
        </div>

        <button class="ctrl-btn text-btn" onclick="toggleTextInput()">
          <span>âŒ¨ï¸</span>
          <span class="ctrl-lbl">Type</span>
        </button>
      </div>

      <!-- Text input (hidden by default) -->
      <div class="text-row" id="textRow" style="display:none">
        <input type="text" class="text-inp" id="textInput" placeholder="Type your message..." />
        <button class="send-btn" onclick="sendTextMessage()">â¤</button>
      </div>

    </div>
  </div>

  <!-- SCREEN 3: Summary -->
  <div id="summaryScreen" class="screen">
    <div class="summary-wrap">
      <div class="summary-top">
        <div class="trophy">ğŸ†</div>
        <h2 class="summary-title">Session Complete!</h2>
        <p class="summary-sub">Your performance report</p>
      </div>

      <div class="final-stats">
        <div class="fstat">
          <div class="fstat-num" id="fstatExchanges">0</div>
          <div class="fstat-lbl">Exchanges</div>
        </div>
        <div class="fstat">
          <div class="fstat-num" id="fstatWords">0</div>
          <div class="fstat-lbl">Words</div>
        </div>
        <div class="fstat accent">
          <div class="fstat-num" id="fstatScore">â€”</div>
          <div class="fstat-lbl">Avg Score</div>
        </div>
        <div class="fstat">
          <div class="fstat-num" id="fstatDuration">0:00</div>
          <div class="fstat-lbl">Duration</div>
        </div>
      </div>

      <div class="summary-card" id="summaryContent">
        <div class="loading-dots"><span></span><span></span><span></span></div>
      </div>

      <button class="restart-btn" onclick="restartApp()">ğŸ”„ New Session</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
